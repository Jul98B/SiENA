def configure(conf):
	conf.env['libjsoncpp'] = conf.check(mandatory=True, lib='jsoncpp', uselib_store='LIBJSONCPP')

def build(bld):
	module = bld.create_ns3_module('siena', ['core', 'internet', 'flow-monitor', 'lte', 'plc', 'network', 'brite', 'nix-vector-routing']) # 'visualizer'
	module.use.append('LIBJSONCPP')
	module.source = [
		'scenario/Scenario.cc',
		'pandapower/Pandapower.cc',
		'home/SmartHome.cc',
		'home/ConventionalHome.cc',
		'home/Composite.cc',
		'home/GridHome.cc',
		'stats/StatsAnalyzer.cc',
		'stats/StatsExporter.cc',
		'stats/MyStats.cc',
		'devices/Device.cc',
		'devices/Battery.cc',
		'devices/WaterTank.cc',
		'devices/Car.cc',
		'devices/BaseLoad.cc',
		'devices/DeviceHelper.cc',
		'devices/CHPS.cc',
		'devices/PV.cc',
		'devices/HeatingRod.cc',
		'devices/HeatPump.cc',
		'devices/ShiftableDevice.cc',
		'server/Server.cc',
		'server/ClusterServer.cc',
		'network/Token.cc',
		'network/Communicator.cc',
		'network/BackgroundTraffic_Device.cc',
		'network/BackgroundTraffic_App.cc',
		'simulator/SiENASimulator.cc',
		'simulator/Tick.cc',
		'simulator/DataBasis.cc',
		'modules/network/tree/NetworkTree.cc'
	]

	headers = bld(features='ns3header')
	headers.module = 'siena'
	headers.source = [
		'scenario/DeviceConfig.h',
		'scenario/HomeConfig.h',
		'scenario/ClusterConfig.h',
		'scenario/Scenario.h',
		'scenario/DeviceConfigHelper.h',
		'scenario/CompositeConfig.h',
		'pandapower/Pandapower.h',
		'home/HeatHelper.h',
		'home/GridHome.h',
		'home/Composite.h',
		'home/HomeContainer.h',
		'home/GenericDataStorage.h',
		'home/ConventionalHome.h',
		'home/SmartHome.h',
		'stats/PacketLogger.h',
		'stats/DSMQuality.h',
		'stats/MyStats.h',
		'stats/StatsAnalyzer.h',
		'stats/StatsExporter.h',
		'stats/Rscript.h',
		'stats/TraceHelper.h',
		'devices/DeviceEvent.h',
		'devices/CHPS.h',
		'devices/AdaptionFlex.h',
		'devices/BaseLoad.h',
		'devices/AdaptionOnOff.h',
		'devices/HeatSource.h',
		'devices/ShiftableDevice.h',
		'devices/Car.h',
		'devices/PV.h',
		'devices/Adaption.h',
		'devices/HeatingRod.h',
		'devices/HeatPump.h',
		'devices/WaterTank.h',
		'devices/AdaptionCategories.h',
		'devices/Device.h',
		'devices/DeviceHelper.h',
		'devices/Battery.h',
		'server/Server.h',
		'server/ServerContainer.h',
		'server/ClusterServer.h',
		'network/PacketLog.h',
		'network/BackgroundTraffic_Device.h',
		'network/TraceHelperTag.h',
		'network/BackgroundTraffic_App.h',
		'network/Communicator.h',
		'network/Recipient.h',
		'network/AttributeContainer.h',
		'network/Token.h',
		'network/TokenTag.h',
		'simulator/MySingleton.h',
		'simulator/FilePreloader.h',
		'simulator/Turbo.h',
		'simulator/Tick.h',
		'simulator/Log.h',
		'simulator/Random.h',
		'simulator/DsmMode.h',
		'simulator/RunningAvg.h',
		'simulator/Helper.h',
		'simulator/SiENASimulator.h',
		'simulator/DataBasis.h',
		'simulator/MyConfig.h',
		'simulator/Progress.h',
		'modules/Registry.h',
		'modules/Modules.h',
		'modules/privade_plus/PrivadePlus_TokenAdapt.h',
		'modules/privade_plus/PrivadePlus_Aggregator.h',
		'modules/privade_plus/PrivadePlus_Server.h',
		'modules/privade_plus/PrivadePlus_TokenData.h',
		'modules/privade_plus/PrivadePlus_TokenShare.h',
		'modules/privade_plus/PrivadePlus_Helper.h',
		'modules/privade_plus/PrivadePlus_GridHome.h',
		'modules/privade_plus/PrivadePlus_Shift.h',
		'modules/powermatcher/PM_Auctioneer.h',
		'modules/powermatcher/PM_DeviceAgent_Battery.h',
		'modules/powermatcher/PM_Concentrator.h',
		'modules/powermatcher/PM_Bid.h',
		'modules/powermatcher/PM_DeviceAgent_CHP.h',
		'modules/powermatcher/PM_GridHome.h',
		'modules/powermatcher/PM_Helper.h',
		'modules/powermatcher/PM_DeviceAgent_HP.h',
		'modules/powermatcher/PM_DeviceAgent_Heatingrod.h',
		'modules/powermatcher/PM_DeviceAgent_Car.h',
		'modules/powermatcher/PM_PriceUpdate.h',
		'modules/powermatcher/PM_DeviceAgent_Basic.h',
		'modules/smarthome/SmartHomeAlgos.h',
		'modules/cohda/COHDA_OverlayNetwork.h',
		'modules/cohda/COHDA_AdaptOnOff.h',
		'modules/cohda/COHDA_GridHome.h',
		'modules/cohda/COHDA_Helper.h',
		'modules/cohda/COHDA_ScheduleSelectionStore.h',
		'modules/cohda/COHDA_AdaptFlex.h',
		'modules/cohda/COHDA_Configuration.h',
		'modules/cohda/COHDA_Server.h',
		'modules/cohda/COHDA_SolutionCandidate.h',
		'modules/cohda/COHDA_Token.h',
		'modules/cohda/COHDA_ScheduleSelection.h',
		'modules/cohda/COHDA_WorkingMemory.h',
		'modules/pppm/PPPM_Update.h',
		'modules/pppm/PPPM_Concentrator.h',
		'modules/pppm/PPPM_Auctioneer.h',
		'modules/pppm/PPPM_GridHome.h',
		'modules/pppm/PPPM_Bid.h',
		'modules/privade/Priv_Server.h',
		'modules/privade/Priv_GridHome.h',
		'modules/privade/Priv_ClusterServer.h',
		'modules/privade/Priv_TokenData.h',
		'modules/privade/Priv_TokenAdapt.h',
		'modules/privade/Priv_Shift.h',
		'modules/privade/Priv_TokenCluster.h',
		'modules/privade/Priv_Helper.h',
		'modules/network/Network_HomeHelper.h',
		'modules/network/Network_Utilities.h',
		'modules/network/brite/Network_BRITE.h',
		'modules/network/plc/Network_PLC.h',
		'modules/network/lte/PacketDelay.h',
		'modules/network/lte/Network_LTE.h',
		'modules/network/lte/Network_LTE_Helper.h',
		'modules/network/lte/DelayTag.h',
		'modules/network/tree/NetworkTreeNode.h',
		'modules/network/tree/NetworkTree.h',
		'modules/network/tree/NetworkTree_Module.h',
		'modules/miscellaneous/Do_Not_Shift.h',
		'modules/miscellaneous/Shift_H0.h'
	]
